# Data Integration and Optimization Enhancement Plan

This document outlines the plan to integrate multiple new data sources (`train_info.csv`, `train_schedule.csv`, `routes.csv`, `price_data.csv`, and `clean_dataset.csv`) into the FINALTrip project. The goal is to enhance the route optimization capabilities to support multimodal journeys (trains and flights) and provide more accurate and comprehensive results.

## 1. Data Analysis and Preprocessing

**Objective:** Consolidate the various CSV files into a unified and structured dataset that can be consumed by the optimization engine.

**New Script:** `data_preprocessor.py`

**Steps:**

1.  **Train Data Consolidation:**
    *   Read `train_info.csv` to get basic train details.
    *   Read `train_schedule.csv` to get detailed stop-by-stop schedule, distance, and pricing information.
    *   Merge these two sources to create a complete view of all train legs, including departure/arrival times, duration, and cost for different classes.

2.  **Flight Data Consolidation:**
    *   Read `routes.csv` to get flight route information (source/destination airports).
    *   Process `price_data.csv` and `Clean_Dataset.csv`. Due to their large size, these files will be processed in chunks. We will assume they contain pricing and other relevant details for the flight routes.
    *   Combine these sources to create a complete view of all flight legs.

3.  **Unified Data Model:**
    *   Create a standardized data model for both train and flight segments. Each segment in the final dataset will have the following attributes:
        *   `type`: 'train' or 'flight'
        *   `unique_id`: A unique identifier for the segment (e.g., train number + route number, or flight number).
        *   `origin`: Station or Airport code.
        *   `destination`: Station or Airport code.
        *   `departure_time`: Standardized datetime format.
        *   `arrival_time`: Standardized datetime format.
        *   `duration_minutes`: Total travel time in minutes.
        *   `cost_inr`: Price in Indian Rupees.
        *   `distance_km`: Distance in kilometers.

4.  **Output:**
    *   The script will generate a single file, `unified_routes.json` or a similar format, containing the processed data for the optimizer.

## 2. Enhancement of the Optimization Engine

**Objective:** Upgrade the Pareto optimization algorithm to support multimodal routing and handle the new unified dataset.

**Modified Script:** `route_optimizer.py`

**Steps:**

1.  **Data Loading:**
    *   Replace the current data loading logic (which uses `train_details.csv`) with a function that loads the `unified_routes.json` file generated by the `data_preprocessor.py`.

2.  **Graph Construction:**
    *   The core data structure will be a graph where nodes represent locations (train stations and airports).
    *   Edges will represent the train and flight segments from the unified dataset, with weights for duration, cost, etc.

3.  **Multimodal Pathfinding:**
    *   Implement logic to find paths that can combine train and flight segments.
    *   This requires identifying "transfer points" - train stations and airports located in the same city. A mapping between major city stations and their corresponding airports will be created.
    *   A "transfer penalty" (time and cost) will be added to the calculations for routes that switch between transport modes (e.g., taxi from station to airport).

4.  **Pareto Optimization:**
    *   The existing Pareto optimization logic will be adapted to work with the new graph structure. It will continue to find the optimal trade-offs between total travel time and total cost.

5.  **Output:**
    *   The optimizer will produce a list of Pareto-optimal routes, where each route is a sequence of train and/or flight segments. The output will be saved in CSV and JSON formats, as is currently done.

## 3. API and Frontend Integration

**Objective:** Connect the enhanced backend to the user interface.

**Modified Scripts:** `api.py`, `src/pages/Index.tsx`, `src/components/RouteCard.tsx`

**Steps:**

1.  **API Modification (`api.py`):**
    *   The API endpoint that handles route search requests will be updated. It will take the origin and destination cities as input.
    *   It will call the updated `route_optimizer.py` and receive the list of optimal multimodal routes.
    *   The results will be formatted into a JSON response suitable for the frontend.

2.  **Frontend Display (`Index.tsx`, `RouteCard.tsx`):**
    *   The frontend will be modified to send the origin/destination search query to the updated API endpoint.
    *   The `RouteCard` component will be redesigned to clearly display multimodal journeys. This includes:
        *   Showing icons to distinguish between train and flight segments.
        *   Clearly listing each leg of the journey, including transfers.
        *   Displaying total time, cost, and other relevant metrics for the entire route.
    *   The main page will display the top 20 routes returned by the API.
